<!-- 骨架屏 -->
<import src="skeleton.wxml" />
<template is="skeleton" wx:if="{{skeletonLoading}}" />
<!-- 主体 -->
<view class="page-wrapper" wx:else="{{skeletonLoading}}">
  <view class="page-head filter-bar">
    <t-row>
      <t-col span="24">
        <t-dropdown-menu>
          <t-dropdown-item options="{{dropdownArtwork.options}}" placement="right" value="{{dropdownArtwork.value}}" bindchange="onArtworkChange" />
          <t-dropdown-item options="{{dropdownAssign.options}}" placement="right" value="{{dropdownAssign.value}}" bindchange="onAssignChange" />
          <t-dropdown-item options="{{dropdownAssess.options}}" placement="right" value="{{dropdownAssess.value}}" bindchange="onAssessChange" />
        </t-dropdown-menu>
      </t-col>
    </t-row>
  </view>
  <view class="page-main">
    <view class="wrapper">
      <view class="cell" wx:for="{{Data}}" wx:key="index">
        <view class="title-font-main">
          <text>Title：{{ item.title }}</text>
        </view>
        <view class="title-font-other arrange-space-between">
          <text>Name：{{ item.name }}</text>
          <text>Code：{{ item.code }}</text>
        </view>
        <view class="title-font-other">
          <text style="border-bottom: 1px solid currentColor;">材质：{{ item.texture }}</text>
        </view>
        <view class="cell-swiper">
          <t-swiper wx:if="{{item.picture_list.length}}" current="{{current}}" autoplay="{{autoplay}}" duration="{{duration}}" interval="{{interval}}" navigation="{{ { type: 'dots' } }}" list="{{item.picture_list}}" bind:click="onSwiperImagesTap" data-images="{{item.picture_list}}">
          </t-swiper>
          <!-- 无数据时显示占位内容 -->
          <t-image wx:else src="" shape="round" error="slot" width="690rpx" height="384rpx">
            <text class="error-text" slot="error">轮播图加载失败</text>
          </t-image>
        </view>
        <view class="fmr">
          <t-collapse>
            <t-collapse-panel value="0" expandIcon>
              <view slot="header" class="arrange-space-between">
                <text class="title-font-main">FMR 可行性评估：</text>
                <text class="title-font-other">指派FMR：</text>
                <t-link size="small" content="{{pickerLabel}}" hover underline catchtap="onOpenPicker" 
                data-task-id="{{ item.id }}" />
              </view>
              <view>
                <t-radio-group default-value="" >
                  <t-radio disabled value="0" label="可生产 — 无需进一步说明" allow-uncheck style="text-align: start;" />
                  <t-radio disabled value="1" allow-uncheck>
                    <view slot="label" class="arrange-space-between">
                      <text>可生产 — 需小幅修改（需填写评论）</text>
                      <t-link size="small" content="查看" hover underline  bind:tap="onOpenPopup" data-click-object="fmr"  data-conmment-status="{{item.confirmed2}}" data-fmr-conmment="{{ item.fmr_conmment }}"/>
                    </view>
                  </t-radio>
                  <t-radio disabled value="2" label="不具备可行性（需大幅修改）" allow-uncheck style="text-align: start;" />
                </t-radio-group>
              </view>
            </t-collapse-panel>
          </t-collapse>
        </view>
        <view class="arrange-column">
        <view class="arrange-center" style="margin-bottom: 15rpx;">
          <text class="title-font-main">评估建议：</text>
          <t-link size="small" content="查看评论" hover underline catchtap="onOpenPopup" 
          data-shelley-conmment="{{ item.shelley_conmment }}" data-click-object="shelley"
          data-conmment-status="{{item.confirmed2}}"/>
        </view>
          <t-radio-group t-class="radio-horizontal-box" value="{{item.confirmed2}}" bind:change="onRadioChange"
          data-confirmed2="{{item.confirmed2}}" data-timelineid="{{ item.timeline_id }}" data-conmment="{{ item.conmment }}"
          >
            <view class="radio-card   {{ item.confirmed2 == 1 ? 'radio-active' : ''}}">
              <t-icon name="check" t-class="radio-icon" />
              <t-radio value="1" label="可生产" icon="none" borderless />
            </view>
            <view class="radio-card  {{ item.confirmed2 == 2 ? 'radio-active' : ''}}">
              <t-icon name="check" t-class="radio-icon" />
              <t-radio value="2" label="小幅度修改" icon="none" borderless t-class="radio-text" />
            </view>
            <view class="radio-card  {{ item.confirmed2 == 3 ? 'radio-active' : ''}}">
              <t-icon name="check" t-class=radio-icon" />
              <t-radio value="3" label="不具备可行性" icon="none" borderless />
            </view>
          </t-radio-group>
        </view>
      </view>
    </view>
  </view>
  <!-- 当下拉时,进行显示的内容  -->
  <view class="loading-box loading-flex" wx:if="{{isLoadingReachMore}}">
    <!-- <text class="loading-text">加载中...</text> -->
    <t-loading theme="dots" size="60rpx" />
  </view>
  <view class="loading-box" wx:if="{{noMoreData}}">
    <text class="loading-text">-- 已经到底了 --</text>
  </view>
</view>
<!-- 轻提示 -->
<t-toast id="t-toast" />
<!-- 回到顶部 -->
<t-back-top theme="half-round" text="顶部" scroll-top="{{scrollTop}}" bind:to-top="onToTop" />
<!-- 查看自评弹窗 -->
<t-popup visible="{{popupVisible}}" bind:visible-change="onClosePopup" placement="bottom">
  <view class="popup-block">
    <view class="popup-header">
      <view class="popup-title">当前评论：</view>
    </view>
    <view class="popup-comments">
      <text>{{ popupValue }}</text>
    </view>
  </view>
</t-popup>
<!-- 评论弹窗 -->
<t-dialog visible="{{dialogVisible}}" title="评估建议：" confirm-btn="确定" cancel-btn="取消" bind:confirm="onCloseDialog" bind:cancel="onCloseDialog">
  <view slot="content">
    <view class="dialog-textarea">
      <t-textarea value="{{ dialogValue }}" placeholder="请输入评审意见" bordered maxlength="200" disableDefaultPadding="true" indicator bind:change="onDialogInput" />
    </view>
  </view>
</t-dialog>
<!-- FMR下拉框 -->
<t-picker visible="{{pickerVisible}}" value="{{pickerValue}}" title="请选择FMR" cancelBtn="取消" confirmBtn="确认" bindchange="onPickerChange" bindcancel="onClosePicker" catchtouchmove>
  <t-picker-item options="{{pickerItemList}}"></t-picker-item>
</t-picker>